<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creative Fatigue Predictor (LinkedIn)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: pointer;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 220px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 0;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -110px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.8rem;
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            background: #3b82f6; /* bg-blue-500 */
            border-radius: 50%;
            cursor: pointer;
        }
        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #3b82f6;
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }
    </style>
</head>
<body class="bg-slate-100 text-slate-800 flex flex-col items-center justify-center min-h-screen p-4 selection:bg-blue-500 selection:text-white">

    <div class="bg-white shadow-xl rounded-lg p-6 md:p-10 w-full max-w-3xl">
        <header class="mb-8 text-center">
            <h1 class="text-3xl md:text-4xl font-bold text-blue-600">Creative Fatigue Predictor</h1>
            <p class="text-slate-600 mt-2">Estimate when ad fatigue might set in for your LinkedIn campaigns.</p>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
            <div class="space-y-4">
                <div>
                    <label for="totalAudience" class="block text-sm font-medium text-slate-700 mb-1">Total Audience Size <span class="text-red-500">*</span></label>
                    <input type="number" id="totalAudience" value="1000000" class="w-full p-3 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500" placeholder="e.g., 1000000">
                </div>
                <div>
                    <label for="budget" class="block text-sm font-medium text-slate-700 mb-1">Total Budget (USD) <span class="text-red-500">*</span></label>
                    <input type="number" id="budget" value="10000" class="w-full p-3 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500" placeholder="e.g., 10000">
                </div>
                <div>
                    <label for="startDate" class="block text-sm font-medium text-slate-700 mb-1">Campaign Start Date <span class="text-red-500">*</span></label>
                    <input type="date" id="startDate" class="w-full p-3 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
            </div>

            <div class="space-y-4">
                <div>
                    <label for="penetrationRate" class="block text-sm font-medium text-slate-700 mb-1">
                        Audience Penetration Rate (%)
                        <span class="tooltip text-blue-500">(?)
                            <span class="tooltiptext">Typical LinkedIn penetration is 20-30%. This is the percentage of the total audience you can realistically reach.</span>
                        </span>
                        <span id="penetrationRateValue" class="font-semibold text-blue-600 ml-2">25%</span>
                    </label>
                    <input type="range" id="penetrationRate" min="1" max="100" value="25" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer">
                </div>
                <div>
                    <label for="cpm" class="block text-sm font-medium text-slate-700 mb-1">
                        Average CPM (USD)
                        <span class="tooltip text-blue-500">(?)
                            <span class="tooltiptext">Cost Per Mille (1000 impressions). LinkedIn CPMs often range $200-300, but can vary.</span>
                        </span>
                        <span id="cpmValue" class="font-semibold text-blue-600 ml-2">$250</span>
                    </label>
                    <input type="range" id="cpm" min="50" max="1000" value="250" step="10" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer">
                </div>
                <div>
                    <label for="fatigueFrequency" class="block text-sm font-medium text-slate-700 mb-1">
                        Target Fatigue Frequency
                        <span class="tooltip text-blue-500">(?)
                            <span class="tooltiptext">Number of times an average person in the reached audience sees the ad before fatigue might start. Typically 3-7.</span>
                        </span>
                        <span id="fatigueFrequencyValue" class="font-semibold text-blue-600 ml-2">4</span>
                    </label>
                    <input type="range" id="fatigueFrequency" min="1" max="20" value="4" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer">
                </div>
                <div>
                    <label for="campaignPacingDays" class="block text-sm font-medium text-slate-700 mb-1">
                        Assumed Campaign Pacing (Days)
                        <span class="tooltip text-blue-500">(?)
                            <span class="tooltiptext">Over how many days do you assume the total budget will be spent? This affects the daily impression rate. Common flights are 7-90 days.</span>
                        </span>
                        <span id="campaignPacingDaysValue" class="font-semibold text-blue-600 ml-2">30 days</span>
                    </label>
                    <input type="range" id="campaignPacingDays" min="7" max="120" value="30" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer">
                </div>
            </div>
        </div>

        <div class="text-center mb-8">
            <button id="predictButton" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-8 rounded-lg shadow-md transition duration-150 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50">
                Predict Fatigue Date
            </button>
        </div>

        <div id="resultsSection" class="bg-slate-50 p-6 rounded-lg shadow hidden">
            <h2 class="text-2xl font-semibold text-blue-700 mb-4 text-center">Prediction Results</h2>
            <div id="errorMessage" class="text-red-600 bg-red-100 p-3 rounded-md mb-4 hidden text-center"></div>
            <div id="successMessage" class="space-y-3">
                <p class="text-lg text-center">Creative fatigue is predicted to set in by: <strong id="fatigueDateResult" class="text-2xl text-green-600"></strong></p>
                <hr class="my-4 border-slate-300">
                <h3 class="text-xl font-medium text-slate-700 mt-4 mb-2">Supporting Calculations:</h3>
                <ul class="list-disc list-inside space-y-1 text-sm text-slate-600">
                    <li>Reachable Audience: <strong id="reachableAudienceResult"></strong></li>
                    <li>Total Impressions from Budget: <strong id="totalImpressionsResult"></strong></li>
                    <li>Assumed Daily Spend: <strong id="dailySpendResult"></strong></li>
                    <li>Assumed Daily Impressions: <strong id="dailyImpressionsResult"></strong></li>
                    <li>Impressions Needed to Fatigue Reachable Audience (at target frequency): <strong id="impressionsToFatigueTotalResult"></strong></li>
                    <li>Days to Generate Impressions for Total Fatigue (theoretical): <strong id="daysToGenerateTotalFatigueResult"></strong> days</li>
                    <li>Effective Days Until Fatigue (min of theoretical and pacing): <strong id="effectiveDaysToFatigueResult"></strong> days</li>
                </ul>
                <p class="mt-4 text-xs text-slate-500 text-center">
                    <strong>Note:</strong> This is an estimation based on the provided inputs and assumptions. Actual results may vary due to ad platform algorithms, ad quality, audience behavior, and market competition. The "Assumed Campaign Pacing" is a key factor in this prediction.
                </p>
            </div>
        </div>
    </div>

    <footer class="text-center mt-8 text-sm text-slate-500">
        <p>&copy; <span id="currentYear"></span> Creative Fatigue Predictor. For illustrative purposes.</p>
    </footer>

    <script>
        // Set current year in footer
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        // Set default start date to today
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('startDate').value = today;

        // Update slider value displays
        const sliders = [
            { id: 'penetrationRate', displayId: 'penetrationRateValue', unit: '%' },
            { id: 'cpm', displayId: 'cpmValue', unit: '$', prefix: true },
            { id: 'fatigueFrequency', displayId: 'fatigueFrequencyValue', unit: '' },
            { id: 'campaignPacingDays', displayId: 'campaignPacingDaysValue', unit: ' days' }
        ];

        sliders.forEach(sliderConfig => {
            const slider = document.getElementById(sliderConfig.id);
            const display = document.getElementById(sliderConfig.displayId);
            slider.addEventListener('input', () => {
                display.textContent = (sliderConfig.prefix ? sliderConfig.unit : '') + slider.value + (!sliderConfig.prefix ? sliderConfig.unit : '');
            });
        });

        const predictButton = document.getElementById('predictButton');
        const resultsSection = document.getElementById('resultsSection');
        const errorMessageDiv = document.getElementById('errorMessage');
        const successMessageDiv = document.getElementById('successMessage');

        predictButton.addEventListener('click', () => {
            // Clear previous messages
            errorMessageDiv.classList.add('hidden');
            errorMessageDiv.textContent = '';
            resultsSection.classList.add('hidden');

            // Get input values
            const totalAudience = parseFloat(document.getElementById('totalAudience').value);
            const budget = parseFloat(document.getElementById('budget').value);
            const startDateStr = document.getElementById('startDate').value;
            
            const penetrationRate = parseFloat(document.getElementById('penetrationRate').value) / 100; // Convert to decimal
            const cpm = parseFloat(document.getElementById('cpm').value);
            const fatigueFrequency = parseFloat(document.getElementById('fatigueFrequency').value);
            const campaignPacingDays = parseFloat(document.getElementById('campaignPacingDays').value);

            // --- Input Validation ---
            let errors = [];
            if (isNaN(totalAudience) || totalAudience <= 0) errors.push("Total Audience Size must be a positive number.");
            if (isNaN(budget) || budget <= 0) errors.push("Total Budget must be a positive number.");
            if (!startDateStr) errors.push("Campaign Start Date is required.");
            if (isNaN(penetrationRate) || penetrationRate <= 0 || penetrationRate > 1) errors.push("Penetration Rate must be between 1% and 100%.");
            if (isNaN(cpm) || cpm <= 0) errors.push("CPM must be a positive number.");
            if (isNaN(fatigueFrequency) || fatigueFrequency <= 0) errors.push("Fatigue Frequency must be a positive number.");
            if (isNaN(campaignPacingDays) || campaignPacingDays <= 0) errors.push("Campaign Pacing Days must be a positive number.");
            
            const startDate = new Date(startDateStr + "T00:00:00"); // Ensure local timezone interpretation
            if (isNaN(startDate.getTime())) errors.push("Invalid Start Date format.");


            if (errors.length > 0) {
                errorMessageDiv.innerHTML = errors.join("<br>");
                errorMessageDiv.classList.remove('hidden');
                resultsSection.classList.remove('hidden'); // Show section to display error
                successMessageDiv.classList.add('hidden');
                return;
            }
            
            successMessageDiv.classList.remove('hidden');


            // --- Calculations ---
            const reachableAudience = totalAudience * penetrationRate;
            if (reachableAudience === 0) {
                errorMessageDiv.textContent = "Reachable Audience is zero. Please check Total Audience Size or Penetration Rate.";
                errorMessageDiv.classList.remove('hidden');
                resultsSection.classList.remove('hidden');
                successMessageDiv.classList.add('hidden');
                return;
            }

            const dailySpend = budget / campaignPacingDays;
            if (dailySpend === 0) {
                 errorMessageDiv.textContent = "Daily spend is zero. Check budget or campaign pacing days.";
                errorMessageDiv.classList.remove('hidden');
                resultsSection.classList.remove('hidden');
                successMessageDiv.classList.add('hidden');
                return;
            }
            
            const dailyImpressions = (dailySpend / cpm) * 1000;
             if (dailyImpressions === 0 || isNaN(dailyImpressions) || !isFinite(dailyImpressions)) {
                errorMessageDiv.textContent = "Calculated daily impressions are zero or invalid. Check CPM, budget, or pacing days. Ensure CPM is not zero.";
                errorMessageDiv.classList.remove('hidden');
                resultsSection.classList.remove('hidden');
                successMessageDiv.classList.add('hidden');
                return;
            }


            const impressionsToFatigueReachableAudience = reachableAudience * fatigueFrequency;
            const totalImpressionsFromBudget = (budget / cpm) * 1000;

            // Theoretical days to generate enough impressions to fatigue the entire reachable audience
            const daysToGenerateEnoughImpressionsForTotalFatigue = impressionsToFatigueReachableAudience / dailyImpressions;

            // Effective days until fatigue: minimum of theoretical days and campaign pacing days
            // This means fatigue sets in either when enough impressions are delivered OR when the campaign (budget) ends, whichever is sooner.
            const effectiveDaysToFatigue = Math.min(daysToGenerateEnoughImpressionsForTotalFatigue, campaignPacingDays);
            
            const finalEffectiveDays = Math.ceil(effectiveDaysToFatigue); // Round up to the next full day

            const fatigueDate = new Date(startDate);
            fatigueDate.setDate(startDate.getDate() + finalEffectiveDays);

            // --- Display Results ---
            document.getElementById('fatigueDateResult').textContent = fatigueDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
            
            document.getElementById('reachableAudienceResult').textContent = Math.round(reachableAudience).toLocaleString();
            document.getElementById('totalImpressionsResult').textContent = Math.round(totalImpressionsFromBudget).toLocaleString();
            document.getElementById('dailySpendResult').textContent = `$${dailySpend.toFixed(2).toLocaleString()}`;
            document.getElementById('dailyImpressionsResult').textContent = Math.round(dailyImpressions).toLocaleString();
            document.getElementById('impressionsToFatigueTotalResult').textContent = Math.round(impressionsToFatigueReachableAudience).toLocaleString();
            document.getElementById('daysToGenerateTotalFatigueResult').textContent = daysToGenerateEnoughImpressionsForTotalFatigue.toFixed(1);
            document.getElementById('effectiveDaysToFatigueResult').textContent = finalEffectiveDays;

            resultsSection.classList.remove('hidden');
        });
    </script>

</body>
</html>
